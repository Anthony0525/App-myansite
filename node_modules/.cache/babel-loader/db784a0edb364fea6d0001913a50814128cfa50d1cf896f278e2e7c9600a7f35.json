{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, normalizeStyle as _normalizeStyle, unref as _unref, createVNode as _createVNode, withCtx as _withCtx, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"container\"\n};\nconst _hoisted_2 = {\n  class: \"main-content\"\n};\nconst _hoisted_3 = {\n  class: \"card-header\"\n};\nconst _hoisted_4 = [\"src\"];\nconst _hoisted_5 = [\"src\"];\nconst _hoisted_6 = {\n  class: \"sidebar\"\n};\nconst _hoisted_7 = {\n  class: \"suggestions\"\n};\nconst _hoisted_8 = {\n  class: \"suggestions-list\"\n};\nconst _hoisted_9 = {\n  key: 0,\n  class: \"loader\"\n};\nimport { ref, onMounted } from \"vue\";\nimport { createClient } from \"@supabase/supabase-js\";\nimport { IonPage, IonContent, IonInfiniteScroll, IonInfiniteScrollContent // üëà Importa los componentes de Infinite Scroll\n} from \"@ionic/vue\";\nimport \"../assets/contenido.css\";\n\n// Revisa que tengas estos componentes importados en MainLayout.vue\n// import { IonPage, IonHeader, IonToolbar, IonContent, IonRouterOutlet } from \"@ionic/vue\";\n\nconst limite = 5;\nexport default {\n  __name: 'ContenidoView',\n  setup(__props) {\n    const supabase = createClient(\"https://neffqwnqpcydidpkysfi.supabase.co\", \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5lZmZxd25xcGN5ZGlkcGt5c2ZpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY3Nzc5MTUsImV4cCI6MjA3MjM1MzkxNX0.I_fwrJYMhKoh2Irlhqub3B5Kn4-JxuJR-XnLhGjUykw\");\n    const publicaciones = ref([]);\n    const cargando = ref(false);\n    const pagina = ref(0);\n    const hayMasDatos = ref(true); // Controla si ya no hay m√°s para cargar\n\n    async function cargarPublicaciones() {\n      if (cargando.value) return;\n      cargando.value = true;\n      const startIndex = pagina.value * limite;\n      const endIndex = startIndex + limite - 1;\n      const {\n        data,\n        error\n      } = await supabase.from(\"publicaciones\").select(`id, nombre_publicacion, descripcion, media_url, perfiles (nombre_perfil, icono_url)`).order(\"created_at\", {\n        ascending: false\n      }).range(startIndex, endIndex);\n      cargando.value = false;\n      if (error) {\n        console.error(\"Error al cargar publicaciones:\", error);\n        hayMasDatos.value = false;\n        return;\n      }\n      if (data && data.length) {\n        publicaciones.value.push(...data);\n        pagina.value++;\n        // Si la cantidad de datos es menor que el l√≠mite, asumimos que no hay m√°s p√°ginas\n        if (data.length < limite) {\n          hayMasDatos.value = false;\n        }\n      } else {\n        // Si no hay datos, deshabilitamos la carga infinita\n        hayMasDatos.value = false;\n      }\n    }\n\n    // üí° FUNCI√ìN LLAMADA POR IONIC\n    async function cargarMasPublicaciones(event) {\n      // Si no hay m√°s datos, detenemos la funci√≥n.\n      if (!hayMasDatos.value) {\n        // Debemos completar el evento, aunque no haya cargado nada.\n        event.target.complete();\n        return;\n      }\n      await cargarPublicaciones();\n\n      // üîë IMPORTANTE: Finaliza el evento de carga de Ionic\n      event.target.complete();\n    }\n    onMounted(() => {\n      // Solo se carga la primera p√°gina al montar, el scroll lo manejar√° el IonInfiniteScroll\n      cargarPublicaciones();\n      // ‚ùå Se elimin√≥ la funci√≥n handleScroll y el window.addEventListener(\"scroll\", handleScroll)\n    });\n    return (_ctx, _cache) => {\n      return _openBlock(), _createBlock(_unref(IonPage), null, {\n        default: _withCtx(() => [_createVNode(_unref(IonContent), null, {\n          default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"main\", _hoisted_2, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(publicaciones.value, pub => {\n            return _openBlock(), _createElementBlock(\"div\", {\n              key: pub.id,\n              class: \"card\"\n            }, [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"img\", {\n              src: pub.perfiles?.icono_url || 'https://i.pravatar.cc/40',\n              class: \"perfil-icono\"\n            }, null, 8, _hoisted_4), _createElementVNode(\"span\", null, _toDisplayString(pub.perfiles?.nombre_perfil || \"An√≥nimo\"), 1)]), _createElementVNode(\"h2\", null, _toDisplayString(pub.nombre_publicacion), 1), _createElementVNode(\"p\", null, _toDisplayString(pub.descripcion), 1), pub.media_url ? (_openBlock(), _createElementBlock(\"img\", {\n              key: 0,\n              src: pub.media_url,\n              class: \"media\"\n            }, null, 8, _hoisted_5)) : _createCommentVNode(\"\", true)]);\n          }), 128))]), _createElementVNode(\"aside\", _hoisted_6, [_createElementVNode(\"div\", _hoisted_7, [_cache[0] || (_cache[0] = _createElementVNode(\"p\", {\n            class: \"suggestions-title\"\n          }, \"Sugeridos!\", -1)), _createElementVNode(\"div\", _hoisted_8, [(_openBlock(), _createElementBlock(_Fragment, null, _renderList(6, i => {\n            return _createElementVNode(\"div\", {\n              key: i,\n              class: \"suggestion-icon\",\n              style: _normalizeStyle(`background-image:url(https://i.pravatar.cc/50?img=${i})`)\n            }, null, 4);\n          }), 64))])])])]), _createVNode(_unref(IonInfiniteScroll), {\n            onIonInfinite: cargarMasPublicaciones,\n            disabled: !hayMasDatos.value\n          }, {\n            default: _withCtx(() => [_createVNode(_unref(IonInfiniteScrollContent), {\n              \"loading-spinner\": \"bubbles\",\n              \"loading-text\": \"Cargando m√°s publicaciones...\"\n            })]),\n            _: 1\n          }, 8, [\"disabled\"]), cargando.value ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, \"Cargando...\")) : _createCommentVNode(\"\", true)]),\n          _: 1\n        })]),\n        _: 1\n      });\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","createClient","IonPage","IonContent","IonInfiniteScroll","IonInfiniteScrollContent","limite","supabase","publicaciones","cargando","pagina","hayMasDatos","cargarPublicaciones","value","startIndex","endIndex","data","error","from","select","order","ascending","range","console","length","push","cargarMasPublicaciones","event","target","complete"],"sources":["C:/Users/ellen/Downloads/App Myansite/Myansite Ionic/Myansite/Myansite/src/views/ContenidoView.vue"],"sourcesContent":["<template>\r\n  <IonPage>\r\n    <IonContent>\r\n      <div class=\"container\">\r\n        <main class=\"main-content\">\r\n          <div v-for=\"pub in publicaciones\" :key=\"pub.id\" class=\"card\">\r\n            <div class=\"card-header\">\r\n              <img\r\n                :src=\"pub.perfiles?.icono_url || 'https://i.pravatar.cc/40'\"\r\n                class=\"perfil-icono\"\r\n              />\r\n              <span>{{ pub.perfiles?.nombre_perfil || \"An√≥nimo\" }}</span>\r\n            </div>\r\n            <h2>{{ pub.nombre_publicacion }}</h2>\r\n            <p>{{ pub.descripcion }}</p>\r\n            <img v-if=\"pub.media_url\" :src=\"pub.media_url\" class=\"media\" />\r\n          </div>\r\n        </main>\r\n\r\n        <aside class=\"sidebar\">\r\n          <div class=\"suggestions\">\r\n            <p class=\"suggestions-title\">Sugeridos!</p>\r\n            <div class=\"suggestions-list\">\r\n              <div\r\n                v-for=\"i in 6\"\r\n                :key=\"i\"\r\n                class=\"suggestion-icon\"\r\n                :style=\"`background-image:url(https://i.pravatar.cc/50?img=${i})`\"\r\n              ></div>\r\n            </div>\r\n          </div>\r\n        </aside>\r\n      </div>\r\n\r\n      <IonInfiniteScroll\r\n        @ionInfinite=\"cargarMasPublicaciones\"\r\n        :disabled=\"!hayMasDatos\"\r\n      >\r\n        <IonInfiniteScrollContent\r\n          loading-spinner=\"bubbles\"\r\n          loading-text=\"Cargando m√°s publicaciones...\"\r\n        ></IonInfiniteScrollContent>\r\n      </IonInfiniteScroll>\r\n\r\n      <div v-if=\"cargando\" class=\"loader\">Cargando...</div>\r\n    </IonContent>\r\n  </IonPage>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from \"vue\";\r\nimport { createClient } from \"@supabase/supabase-js\";\r\nimport { \r\n    IonPage, \r\n    IonContent, \r\n    IonInfiniteScroll, \r\n    IonInfiniteScrollContent // üëà Importa los componentes de Infinite Scroll\r\n} from \"@ionic/vue\";\r\nimport \"../assets/contenido.css\";\r\n\r\n// Revisa que tengas estos componentes importados en MainLayout.vue\r\n// import { IonPage, IonHeader, IonToolbar, IonContent, IonRouterOutlet } from \"@ionic/vue\";\r\n\r\nconst supabase = createClient(\r\n  \"https://neffqwnqpcydidpkysfi.supabase.co\",\r\n  \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5lZmZxd25xcGN5ZGlkcGt5c2ZpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY3Nzc5MTUsImV4cCI6MjA3MjM1MzkxNX0.I_fwrJYMhKoh2Irlhqub3B5Kn4-JxuJR-XnLhGjUykw\"\r\n);\r\n\r\nconst publicaciones = ref([]);\r\nconst cargando = ref(false);\r\nconst pagina = ref(0);\r\nconst limite = 5;\r\nconst hayMasDatos = ref(true); // Controla si ya no hay m√°s para cargar\r\n\r\nasync function cargarPublicaciones() {\r\n  if (cargando.value) return; \r\n\r\n  cargando.value = true;\r\n  \r\n  const startIndex = pagina.value * limite;\r\n  const endIndex = startIndex + limite - 1;\r\n\r\n  const { data, error } = await supabase\r\n    .from(\"publicaciones\")\r\n    .select(\r\n      `id, nombre_publicacion, descripcion, media_url, perfiles (nombre_perfil, icono_url)`\r\n    )\r\n    .order(\"created_at\", { ascending: false })\r\n    .range(startIndex, endIndex);\r\n\r\n  cargando.value = false;\r\n  \r\n  if (error) {\r\n    console.error(\"Error al cargar publicaciones:\", error);\r\n    hayMasDatos.value = false;\r\n    return;\r\n  }\r\n\r\n  if (data && data.length) {\r\n    publicaciones.value.push(...data);\r\n    pagina.value++;\r\n    // Si la cantidad de datos es menor que el l√≠mite, asumimos que no hay m√°s p√°ginas\r\n    if (data.length < limite) {\r\n        hayMasDatos.value = false;\r\n    }\r\n  } else {\r\n    // Si no hay datos, deshabilitamos la carga infinita\r\n    hayMasDatos.value = false;\r\n  }\r\n}\r\n\r\n// üí° FUNCI√ìN LLAMADA POR IONIC\r\nasync function cargarMasPublicaciones(event) {\r\n    // Si no hay m√°s datos, detenemos la funci√≥n.\r\n    if (!hayMasDatos.value) {\r\n        // Debemos completar el evento, aunque no haya cargado nada.\r\n        event.target.complete(); \r\n        return;\r\n    }\r\n    \r\n    await cargarPublicaciones();\r\n\r\n    // üîë IMPORTANTE: Finaliza el evento de carga de Ionic\r\n    event.target.complete();\r\n}\r\n\r\n\r\nonMounted(() => {\r\n  // Solo se carga la primera p√°gina al montar, el scroll lo manejar√° el IonInfiniteScroll\r\n  cargarPublicaciones();\r\n  // ‚ùå Se elimin√≥ la funci√≥n handleScroll y el window.addEventListener(\"scroll\", handleScroll)\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n/* Tu CSS espec√≠fico aqu√≠ (si lo tuvieras, adem√°s del import) */\r\n.loader {\r\n    text-align: center;\r\n    padding: 20px;\r\n    color: #ccc;\r\n}\r\n</style>"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAkDA,SAASA,GAAG,EAAEC,SAAS,QAAQ,KAAK;AACpC,SAASC,YAAY,QAAQ,uBAAuB;AACpD,SACIC,OAAO,EACPC,UAAU,EACVC,iBAAiB,EACjBC,wBAAwB,CAAC;AAAA,OACtB,YAAY;AACnB,OAAO,yBAAyB;;AAEhC;AACA;;AAUA,MAAMC,MAAM,GAAG,CAAC;;;;IARhB,MAAMC,QAAQ,GAAGN,YAAY,CAC3B,0CAA0C,EAC1C,kNACF,CAAC;IAED,MAAMO,aAAa,GAAGT,GAAG,CAAC,EAAE,CAAC;IAC7B,MAAMU,QAAQ,GAAGV,GAAG,CAAC,KAAK,CAAC;IAC3B,MAAMW,MAAM,GAAGX,GAAG,CAAC,CAAC,CAAC;IAErB,MAAMY,WAAW,GAAGZ,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;;IAE/B,eAAea,mBAAmBA,CAAA,EAAG;MACnC,IAAIH,QAAQ,CAACI,KAAK,EAAE;MAEpBJ,QAAQ,CAACI,KAAK,GAAG,IAAI;MAErB,MAAMC,UAAU,GAAGJ,MAAM,CAACG,KAAK,GAAGP,MAAM;MACxC,MAAMS,QAAQ,GAAGD,UAAU,GAAGR,MAAM,GAAG,CAAC;MAExC,MAAM;QAAEU,IAAI;QAAEC;MAAM,CAAC,GAAG,MAAMV,QAAQ,CACnCW,IAAI,CAAC,eAAe,CAAC,CACrBC,MAAM,CACL,qFACF,CAAC,CACAC,KAAK,CAAC,YAAY,EAAE;QAAEC,SAAS,EAAE;MAAM,CAAC,CAAC,CACzCC,KAAK,CAACR,UAAU,EAAEC,QAAQ,CAAC;MAE9BN,QAAQ,CAACI,KAAK,GAAG,KAAK;MAEtB,IAAII,KAAK,EAAE;QACTM,OAAO,CAACN,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;QACtDN,WAAW,CAACE,KAAK,GAAG,KAAK;QACzB;MACF;MAEA,IAAIG,IAAI,IAAIA,IAAI,CAACQ,MAAM,EAAE;QACvBhB,aAAa,CAACK,KAAK,CAACY,IAAI,CAAC,GAAGT,IAAI,CAAC;QACjCN,MAAM,CAACG,KAAK,EAAE;QACd;QACA,IAAIG,IAAI,CAACQ,MAAM,GAAGlB,MAAM,EAAE;UACtBK,WAAW,CAACE,KAAK,GAAG,KAAK;QAC7B;MACF,CAAC,MAAM;QACL;QACAF,WAAW,CAACE,KAAK,GAAG,KAAK;MAC3B;IACF;;IAEA;IACA,eAAea,sBAAsBA,CAACC,KAAK,EAAE;MACzC;MACA,IAAI,CAAChB,WAAW,CAACE,KAAK,EAAE;QACpB;QACAc,KAAK,CAACC,MAAM,CAACC,QAAQ,CAAC,CAAC;QACvB;MACJ;MAEA,MAAMjB,mBAAmB,CAAC,CAAC;;MAE3B;MACAe,KAAK,CAACC,MAAM,CAACC,QAAQ,CAAC,CAAC;IAC3B;IAGA7B,SAAS,CAAC,MAAM;MACd;MACAY,mBAAmB,CAAC,CAAC;MACrB;IACF,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}