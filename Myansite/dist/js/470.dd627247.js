"use strict";(self["webpackChunkproyectexample"]=self["webpackChunkproyectexample"]||[]).push([[470],{6470:function(e,a,l){l.r(a),l.d(a,{default:function(){return k}});var r=l(6768),t=l(144),o=l(4232),s=l(4790);const n="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='m112 184 144 144 144-144' stroke-linecap='round' stroke-linejoin='round' stroke-width='48px' class='ionicon-fill-none'/></svg>";var u=l(1300);const i={class:"ion-padding"},c={class:"ion-padding"},d={class:"user-info-section"};var f={__name:"PerfilView",setup(e){const a=(0,u.UU)("https://neffqwnqpcydidpkysfi.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."),l=(0,t.KR)({username:"",avatar_url:"",gustos:[],logros:[]}),f=(0,t.KR)(null),p=()=>{f.value.click()},v=async e=>{const r=e.target.files[0];if(r)try{const e=`avatars/${l.value.username}/${Date.now()}.${r.name.split(".").pop()}`,{data:t,error:o}=await a.storage.from("avatars").upload(e,r);if(o)throw o;const s=`https://neffqwnqpcydidpkysfi.supabase.co/storage/v1/object/public/${t.path}`,{error:n}=await a.from("profiles").update({avatar_url:s}).eq("username",l.value.username);if(n)throw n;l.value.avatar_url=s,alert("✅ Imagen de perfil actualizada correctamente!")}catch(t){console.error("Error al subir la imagen:",t.message),alert("❌ Error al subir la imagen. Inténtalo de nuevo.")}},k=async()=>{try{const e=JSON.parse(localStorage.getItem("usuario"));if(!e)return void console.warn("No hay usuario autenticado.");const{data:r,error:t}=await a.from("perfiles").select("nombre_perfil, avatar_url, gustos, logros").eq("nombre_perfil",e.nombre).single();if(t)throw t;r&&(l.value.username=r.nombre_perfil,l.value.avatar_url=r.avatar_url,l.value.gustos=r.gustos||[],l.value.logros=r.logros||[])}catch(e){console.error("Error al cargar datos del perfil:",e.message)}};return(0,r.sV)((()=>{k()})),(e,a)=>((0,r.uX)(),(0,r.Wv)((0,t.R1)(s.AO),null,{default:(0,r.k6)((()=>[(0,r.bF)((0,t.R1)(s.eU),null,{default:(0,r.k6)((()=>[(0,r.bF)((0,t.R1)(s.ai),null,{default:(0,r.k6)((()=>[(0,r.bF)((0,t.R1)(s.BC),null,{default:(0,r.k6)((()=>a[0]||(a[0]=[(0,r.eW)("Perfil")]))),_:1})])),_:1})])),_:1}),(0,r.bF)((0,t.R1)(s.W9),{class:"ion-padding"},{default:(0,r.k6)((()=>[(0,r.bF)((0,t.R1)(s.b_),null,{default:(0,r.k6)((()=>[(0,r.bF)((0,t.R1)(s.KW),{src:"",alt:"Fondo del perfil"}),(0,r.bF)((0,t.R1)(s.I9),null,{default:(0,r.k6)((()=>[(0,r.bF)((0,t.R1)(s.YH),null,{default:(0,r.k6)((()=>[(0,r.bF)((0,t.R1)(s.xk),{value:"gustos"},{header:(0,r.k6)((()=>[(0,r.bF)((0,t.R1)(s.uz),{button:""},{default:(0,r.k6)((()=>[(0,r.bF)((0,t.R1)(s.he),null,{default:(0,r.k6)((()=>a[1]||(a[1]=[(0,r.eW)("Gustos")]))),_:1}),(0,r.bF)((0,t.R1)(s.iq),{icon:(0,t.R1)(n),slot:"end"},null,8,["icon"])])),_:1})])),content:(0,r.k6)((()=>[(0,r.Lk)("div",i,[(0,r.Lk)("ul",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.value.gustos,((e,a)=>((0,r.uX)(),(0,r.CE)("li",{key:a},(0,o.v_)(e),1)))),128))])])])),_:1}),(0,r.bF)((0,t.R1)(s.xk),{value:"logros"},{header:(0,r.k6)((()=>[(0,r.bF)((0,t.R1)(s.uz),{button:""},{default:(0,r.k6)((()=>[(0,r.bF)((0,t.R1)(s.he),null,{default:(0,r.k6)((()=>a[2]||(a[2]=[(0,r.eW)("Logros")]))),_:1}),(0,r.bF)((0,t.R1)(s.iq),{icon:(0,t.R1)(n),slot:"end"},null,8,["icon"])])),_:1})])),content:(0,r.k6)((()=>[(0,r.Lk)("div",c,[(0,r.Lk)("ul",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.value.logros,((e,a)=>((0,r.uX)(),(0,r.CE)("li",{key:a},(0,o.v_)(e),1)))),128))])])])),_:1})])),_:1}),(0,r.Lk)("div",d,[(0,r.Lk)("div",{class:"user-avatar-container",onClick:p},[(0,r.bF)((0,t.R1)(s.mC),null,{default:(0,r.k6)((()=>[(0,r.bF)((0,t.R1)(s.KW),{src:l.value.avatar_url,alt:"Avatar del usuario"},null,8,["src"])])),_:1}),(0,r.Lk)("input",{type:"file",ref_key:"avatarInput",ref:f,style:{display:"none"},onChange:v,accept:"image/*"},null,544)]),(0,r.bF)((0,t.R1)(s.he),{class:"username"},{default:(0,r.k6)((()=>[(0,r.eW)((0,o.v_)(l.value.username),1)])),_:1})])])),_:1})])),_:1})])),_:1})])),_:1}))}},p=l(1241);const v=(0,p.A)(f,[["__scopeId","data-v-484035ce"]]);var k=v}}]);