{"ast":null,"code":"import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, normalizeStyle as _normalizeStyle, createVNode as _createVNode, withCtx as _withCtx, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"container\"\n};\nconst _hoisted_2 = {\n  class: \"main-content\"\n};\nconst _hoisted_3 = {\n  class: \"card-header\"\n};\nconst _hoisted_4 = [\"src\"];\nconst _hoisted_5 = [\"src\"];\nconst _hoisted_6 = {\n  class: \"sidebar\"\n};\nconst _hoisted_7 = {\n  class: \"suggestions\"\n};\nconst _hoisted_8 = {\n  class: \"suggestions-list\"\n};\nconst _hoisted_9 = {\n  key: 0,\n  class: \"loader\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createBlock($setup[\"IonPage\"], null, {\n    default: _withCtx(() => [_createVNode($setup[\"IonContent\"], null, {\n      default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"main\", _hoisted_2, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.publicaciones, pub => {\n        return _openBlock(), _createElementBlock(\"div\", {\n          key: pub.id,\n          class: \"card\"\n        }, [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"img\", {\n          src: pub.perfiles?.icono_url || 'https://i.pravatar.cc/40',\n          class: \"perfil-icono\"\n        }, null, 8 /* PROPS */, _hoisted_4), _createElementVNode(\"span\", null, _toDisplayString(pub.perfiles?.nombre_perfil || \"An√≥nimo\"), 1 /* TEXT */)]), _createElementVNode(\"h2\", null, _toDisplayString(pub.nombre_publicacion), 1 /* TEXT */), _createElementVNode(\"p\", null, _toDisplayString(pub.descripcion), 1 /* TEXT */), pub.media_url ? (_openBlock(), _createElementBlock(\"img\", {\n          key: 0,\n          src: pub.media_url,\n          class: \"media\"\n        }, null, 8 /* PROPS */, _hoisted_5)) : _createCommentVNode(\"v-if\", true)]);\n      }), 128 /* KEYED_FRAGMENT */))]), _createElementVNode(\"aside\", _hoisted_6, [_createElementVNode(\"div\", _hoisted_7, [_cache[0] || (_cache[0] = _createElementVNode(\"p\", {\n        class: \"suggestions-title\"\n      }, \"Sugeridos!\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_8, [(_openBlock(), _createElementBlock(_Fragment, null, _renderList(6, i => {\n        return _createElementVNode(\"div\", {\n          key: i,\n          class: \"suggestion-icon\",\n          style: _normalizeStyle(`background-image:url(https://i.pravatar.cc/50?img=${i})`)\n        }, null, 4 /* STYLE */);\n      }), 64 /* STABLE_FRAGMENT */))])])])]), _createVNode($setup[\"IonInfiniteScroll\"], {\n        onIonInfinite: $setup.cargarMasPublicaciones,\n        disabled: !$setup.hayMasDatos\n      }, {\n        default: _withCtx(() => [_createVNode($setup[\"IonInfiniteScrollContent\"], {\n          \"loading-spinner\": \"bubbles\",\n          \"loading-text\": \"Cargando m√°s publicaciones...\"\n        })]),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"disabled\"]), $setup.cargando ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, \"Cargando...\")) : _createCommentVNode(\"v-if\", true)]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  });\n}","map":{"version":3,"names":["class","key","_createBlock","$setup","default","_withCtx","_createVNode","_createElementVNode","_hoisted_1","_hoisted_2","_createElementBlock","_Fragment","_renderList","publicaciones","pub","id","_hoisted_3","src","perfiles","icono_url","_hoisted_4","_toDisplayString","nombre_perfil","nombre_publicacion","descripcion","media_url","_hoisted_5","_createCommentVNode","_hoisted_6","_hoisted_7","_hoisted_8","i","style","_normalizeStyle","onIonInfinite","cargarMasPublicaciones","disabled","hayMasDatos","_","cargando","_hoisted_9"],"sources":["C:\\Users\\ellen\\Downloads\\App Myansite\\Myansite Ionic\\Myansite\\Myansite\\src\\views\\ContenidoView.vue"],"sourcesContent":["<template>\r\n  <IonPage>\r\n    <IonContent>\r\n      <div class=\"container\">\r\n        <main class=\"main-content\">\r\n          <div v-for=\"pub in publicaciones\" :key=\"pub.id\" class=\"card\">\r\n            <div class=\"card-header\">\r\n              <img\r\n                :src=\"pub.perfiles?.icono_url || 'https://i.pravatar.cc/40'\"\r\n                class=\"perfil-icono\"\r\n              />\r\n              <span>{{ pub.perfiles?.nombre_perfil || \"An√≥nimo\" }}</span>\r\n            </div>\r\n            <h2>{{ pub.nombre_publicacion }}</h2>\r\n            <p>{{ pub.descripcion }}</p>\r\n            <img v-if=\"pub.media_url\" :src=\"pub.media_url\" class=\"media\" />\r\n          </div>\r\n        </main>\r\n\r\n        <aside class=\"sidebar\">\r\n          <div class=\"suggestions\">\r\n            <p class=\"suggestions-title\">Sugeridos!</p>\r\n            <div class=\"suggestions-list\">\r\n              <div\r\n                v-for=\"i in 6\"\r\n                :key=\"i\"\r\n                class=\"suggestion-icon\"\r\n                :style=\"`background-image:url(https://i.pravatar.cc/50?img=${i})`\"\r\n              ></div>\r\n            </div>\r\n          </div>\r\n        </aside>\r\n      </div>\r\n\r\n      <IonInfiniteScroll\r\n        @ionInfinite=\"cargarMasPublicaciones\"\r\n        :disabled=\"!hayMasDatos\"\r\n      >\r\n        <IonInfiniteScrollContent\r\n          loading-spinner=\"bubbles\"\r\n          loading-text=\"Cargando m√°s publicaciones...\"\r\n        ></IonInfiniteScrollContent>\r\n      </IonInfiniteScroll>\r\n\r\n      <div v-if=\"cargando\" class=\"loader\">Cargando...</div>\r\n    </IonContent>\r\n  </IonPage>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from \"vue\";\r\nimport { createClient } from \"@supabase/supabase-js\";\r\nimport { \r\n    IonPage, \r\n    IonContent, \r\n    IonInfiniteScroll, \r\n    IonInfiniteScrollContent // üëà Importa los componentes de Infinite Scroll\r\n} from \"@ionic/vue\";\r\nimport \"../assets/contenido.css\";\r\n\r\n// Revisa que tengas estos componentes importados en MainLayout.vue\r\n// import { IonPage, IonHeader, IonToolbar, IonContent, IonRouterOutlet } from \"@ionic/vue\";\r\n\r\nconst supabase = createClient(\r\n  \"https://neffqwnqpcydidpkysfi.supabase.co\",\r\n  \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5lZmZxd25xcGN5ZGlkcGt5c2ZpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY3Nzc5MTUsImV4cCI6MjA3MjM1MzkxNX0.I_fwrJYMhKoh2Irlhqub3B5Kn4-JxuJR-XnLhGjUykw\"\r\n);\r\n\r\nconst publicaciones = ref([]);\r\nconst cargando = ref(false);\r\nconst pagina = ref(0);\r\nconst limite = 5;\r\nconst hayMasDatos = ref(true); // Controla si ya no hay m√°s para cargar\r\n\r\nasync function cargarPublicaciones() {\r\n  if (cargando.value) return; \r\n\r\n  cargando.value = true;\r\n  \r\n  const startIndex = pagina.value * limite;\r\n  const endIndex = startIndex + limite - 1;\r\n\r\n  const { data, error } = await supabase\r\n    .from(\"publicaciones\")\r\n    .select(\r\n      `id, nombre_publicacion, descripcion, media_url, perfiles (nombre_perfil, icono_url)`\r\n    )\r\n    .order(\"created_at\", { ascending: false })\r\n    .range(startIndex, endIndex);\r\n\r\n  cargando.value = false;\r\n  \r\n  if (error) {\r\n    console.error(\"Error al cargar publicaciones:\", error);\r\n    hayMasDatos.value = false;\r\n    return;\r\n  }\r\n\r\n  if (data && data.length) {\r\n    publicaciones.value.push(...data);\r\n    pagina.value++;\r\n    // Si la cantidad de datos es menor que el l√≠mite, asumimos que no hay m√°s p√°ginas\r\n    if (data.length < limite) {\r\n        hayMasDatos.value = false;\r\n    }\r\n  } else {\r\n    // Si no hay datos, deshabilitamos la carga infinita\r\n    hayMasDatos.value = false;\r\n  }\r\n}\r\n\r\n// üí° FUNCI√ìN LLAMADA POR IONIC\r\nasync function cargarMasPublicaciones(event) {\r\n    // Si no hay m√°s datos, detenemos la funci√≥n.\r\n    if (!hayMasDatos.value) {\r\n        // Debemos completar el evento, aunque no haya cargado nada.\r\n        event.target.complete(); \r\n        return;\r\n    }\r\n    \r\n    await cargarPublicaciones();\r\n\r\n    // üîë IMPORTANTE: Finaliza el evento de carga de Ionic\r\n    event.target.complete();\r\n}\r\n\r\n\r\nonMounted(() => {\r\n  // Solo se carga la primera p√°gina al montar, el scroll lo manejar√° el IonInfiniteScroll\r\n  cargarPublicaciones();\r\n  // ‚ùå Se elimin√≥ la funci√≥n handleScroll y el window.addEventListener(\"scroll\", handleScroll)\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n/* Tu CSS espec√≠fico aqu√≠ (si lo tuvieras, adem√°s del import) */\r\n.loader {\r\n    text-align: center;\r\n    padding: 20px;\r\n    color: #ccc;\r\n}\r\n</style>"],"mappings":";;EAGWA,KAAK,EAAC;AAAW;;EACdA,KAAK,EAAC;AAAc;;EAEjBA,KAAK,EAAC;AAAa;mBANpC;mBAAA;;EAmBeA,KAAK,EAAC;AAAS;;EACfA,KAAK,EAAC;AAAa;;EAEjBA,KAAK,EAAC;AAAkB;;EAtBzCC,GAAA;EA4C2BD,KAAK,EAAC;;;uBA3C/BE,YAAA,CA6CUC,MAAA;IA9CZC,OAAA,EAAAC,QAAA,CAEI,MA2Ca,CA3CbC,YAAA,CA2CaH,MAAA;MA7CjBC,OAAA,EAAAC,QAAA,CAGM,MA6BM,CA7BNE,mBAAA,CA6BM,OA7BNC,UA6BM,GA5BJD,mBAAA,CAaO,QAbPE,UAaO,I,kBAZLC,mBAAA,CAWMC,SAAA,QAhBhBC,WAAA,CAK6BT,MAAA,CAAAU,aAAa,EAApBC,GAAG;6BAAfJ,mBAAA,CAWM;UAX6BT,GAAG,EAAEa,GAAG,CAACC,EAAE;UAAEf,KAAK,EAAC;YACpDO,mBAAA,CAMM,OANNS,UAMM,GALJT,mBAAA,CAGE;UAFCU,GAAG,EAAEH,GAAG,CAACI,QAAQ,EAAEC,SAAS;UAC7BnB,KAAK,EAAC;gCATtBoB,UAAA,GAWcb,mBAAA,CAA2D,cAAAc,gBAAA,CAAlDP,GAAG,CAACI,QAAQ,EAAEI,aAAa,8B,GAEtCf,mBAAA,CAAqC,YAAAc,gBAAA,CAA9BP,GAAG,CAACS,kBAAkB,kBAC7BhB,mBAAA,CAA4B,WAAAc,gBAAA,CAAtBP,GAAG,CAACU,WAAW,kBACVV,GAAG,CAACW,SAAS,I,cAAxBf,mBAAA,CAA+D;UAf3ET,GAAA;UAeuCgB,GAAG,EAAEH,GAAG,CAACW,SAAS;UAAEzB,KAAK,EAAC;gCAfjE0B,UAAA,KAAAC,mBAAA,e;wCAmBQpB,mBAAA,CAYQ,SAZRqB,UAYQ,GAXNrB,mBAAA,CAUM,OAVNsB,UAUM,G,0BATJtB,mBAAA,CAA2C;QAAxCP,KAAK,EAAC;MAAmB,GAAC,YAAU,sBACvCO,mBAAA,CAOM,OAPNuB,UAOM,I,cANJpB,mBAAA,CAKOC,SAAA,QA5BrBC,WAAA,CAwB4B,CAAC,EAANmB,CAAC;eADVxB,mBAAA,CAKO;UAHJN,GAAG,EAAE8B,CAAC;UACP/B,KAAK,EAAC,iBAAiB;UACtBgC,KAAK,EA3BtBC,eAAA,sDA2B6EF,CAAC;;8CAOxEzB,YAAA,CAQoBH,MAAA;QAPjB+B,aAAW,EAAE/B,MAAA,CAAAgC,sBAAsB;QACnCC,QAAQ,GAAGjC,MAAA,CAAAkC;;QApCpBjC,OAAA,EAAAC,QAAA,CAsCQ,MAG4B,CAH5BC,YAAA,CAG4BH,MAAA;UAF1B,iBAAe,EAAC,SAAS;UACzB,cAAY,EAAC;;QAxCvBmC,CAAA;uCA4CiBnC,MAAA,CAAAoC,QAAQ,I,cAAnB7B,mBAAA,CAAqD,OAArD8B,UAAqD,EAAjB,aAAW,KA5CrDb,mBAAA,e;MAAAW,CAAA;;IAAAA,CAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}