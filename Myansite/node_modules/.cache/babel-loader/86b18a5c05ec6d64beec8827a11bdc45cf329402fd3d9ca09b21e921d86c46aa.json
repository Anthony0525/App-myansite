{"ast":null,"code":"import { createTextVNode as _createTextVNode, withCtx as _withCtx, createVNode as _createVNode, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"ion-padding\"\n};\nconst _hoisted_2 = {\n  class: \"ion-padding\"\n};\nconst _hoisted_3 = {\n  class: \"user-info-section\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createBlock($setup[\"IonPage\"], null, {\n    default: _withCtx(() => [_createVNode($setup[\"IonHeader\"], null, {\n      default: _withCtx(() => [_createVNode($setup[\"IonToolbar\"], null, {\n        default: _withCtx(() => [_createVNode($setup[\"IonTitle\"], null, {\n          default: _withCtx(() => _cache[2] || (_cache[2] = [_createTextVNode(\"Perfil\")])),\n          _: 1 /* STABLE */\n        })]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    }), _createVNode($setup[\"IonContent\"], {\n      class: \"ion-padding\"\n    }, {\n      default: _withCtx(() => [_createVNode($setup[\"IonCard\"], null, {\n        default: _withCtx(() => [_createCommentVNode(\" Imagen de fondo \"), _createVNode($setup[\"IonImg\"], {\n          src: \"\",\n          alt: \"Fondo del perfil\"\n        }), _createVNode($setup[\"IonCardContent\"], null, {\n          default: _withCtx(() => [_createCommentVNode(\" Acordeón Gustos \"), _createVNode($setup[\"IonAccordionGroup\"], {\n            value: $setup.activeAccordion\n          }, {\n            default: _withCtx(() => [_createVNode($setup[\"IonAccordion\"], {\n              value: \"gustos\"\n            }, {\n              header: _withCtx(() => [_createVNode($setup[\"IonItem\"], {\n                button: \"\",\n                onClick: _cache[0] || (_cache[0] = $event => $setup.toggleAccordion('gustos'))\n              }, {\n                default: _withCtx(() => [_createVNode($setup[\"IonLabel\"], null, {\n                  default: _withCtx(() => _cache[3] || (_cache[3] = [_createTextVNode(\"Gustos\")])),\n                  _: 1 /* STABLE */\n                }), _createVNode($setup[\"IonIcon\"], {\n                  icon: $setup.chevronDown,\n                  slot: \"end\"\n                }, null, 8 /* PROPS */, [\"icon\"])]),\n                _: 1 /* STABLE */\n              })]),\n              content: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"ul\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.profileData.gustos, (gusto, index) => {\n                return _openBlock(), _createElementBlock(\"li\", {\n                  key: index\n                }, _toDisplayString(gusto), 1 /* TEXT */);\n              }), 128 /* KEYED_FRAGMENT */))])])]),\n              _: 1 /* STABLE */\n            }), _createCommentVNode(\" Acordeón Logros \"), _createVNode($setup[\"IonAccordion\"], {\n              value: \"logros\"\n            }, {\n              header: _withCtx(() => [_createVNode($setup[\"IonItem\"], {\n                button: \"\",\n                onClick: _cache[1] || (_cache[1] = $event => $setup.toggleAccordion('logros'))\n              }, {\n                default: _withCtx(() => [_createVNode($setup[\"IonLabel\"], null, {\n                  default: _withCtx(() => _cache[4] || (_cache[4] = [_createTextVNode(\"Logros\")])),\n                  _: 1 /* STABLE */\n                }), _createVNode($setup[\"IonIcon\"], {\n                  icon: $setup.chevronDown,\n                  slot: \"end\"\n                }, null, 8 /* PROPS */, [\"icon\"])]),\n                _: 1 /* STABLE */\n              })]),\n              content: _withCtx(() => [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"ul\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.profileData.logros, (logro, index) => {\n                return _openBlock(), _createElementBlock(\"li\", {\n                  key: index\n                }, _toDisplayString(logro), 1 /* TEXT */);\n              }), 128 /* KEYED_FRAGMENT */))])])]),\n              _: 1 /* STABLE */\n            })]),\n            _: 1 /* STABLE */\n          }, 8 /* PROPS */, [\"value\"]), _createCommentVNode(\" Avatar y usuario \"), _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", {\n            class: \"user-avatar-container\",\n            onClick: $setup.changeAvatar\n          }, [_createVNode($setup[\"IonAvatar\"], null, {\n            default: _withCtx(() => [_createVNode($setup[\"IonImg\"], {\n              src: $setup.profileData.avatar_url,\n              alt: \"Avatar del usuario\"\n            }, null, 8 /* PROPS */, [\"src\"])]),\n            _: 1 /* STABLE */\n          }), _createElementVNode(\"input\", {\n            type: \"file\",\n            ref: \"avatarInput\",\n            style: {\n              \"display\": \"none\"\n            },\n            onChange: $setup.handleFileChange,\n            accept: \"image/*\"\n          }, null, 544 /* NEED_HYDRATION, NEED_PATCH */)]), _createVNode($setup[\"IonLabel\"], {\n            class: \"username\"\n          }, {\n            default: _withCtx(() => [_createTextVNode(_toDisplayString($setup.profileData.username), 1 /* TEXT */)]),\n            _: 1 /* STABLE */\n          })])]),\n          _: 1 /* STABLE */\n        })]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  });\n}","map":{"version":3,"names":["class","_createBlock","$setup","default","_withCtx","_createVNode","_cache","_createTextVNode","_","_createCommentVNode","src","alt","value","activeAccordion","header","button","onClick","$event","toggleAccordion","icon","chevronDown","slot","content","_createElementVNode","_hoisted_1","_createElementBlock","_Fragment","_renderList","profileData","gustos","gusto","index","key","_toDisplayString","_hoisted_2","logros","logro","_hoisted_3","changeAvatar","avatar_url","type","ref","style","onChange","handleFileChange","accept","username"],"sources":["C:\\Users\\ellen\\Downloads\\App Myansite\\Myansite Ionic\\Myansite\\Myansite\\src\\views\\PerfilView.vue"],"sourcesContent":["<template>\r\n  <IonPage>\r\n    <IonHeader>\r\n      <IonToolbar>\r\n        <IonTitle>Perfil</IonTitle>\r\n      </IonToolbar>\r\n    </IonHeader>\r\n\r\n    <IonContent class=\"ion-padding\">\r\n      <IonCard>\r\n        <!-- Imagen de fondo -->\r\n        <IonImg src=\"\" alt=\"Fondo del perfil\" />\r\n\r\n        <IonCardContent>\r\n          <!-- Acordeón Gustos -->\r\n          <IonAccordionGroup :value=\"activeAccordion\">\r\n            <IonAccordion value=\"gustos\">\r\n              <!-- ✅ Migrado: slot=\"header\" -->\r\n              <template #header>\r\n                <IonItem button @click=\"toggleAccordion('gustos')\">\r\n                  <IonLabel>Gustos</IonLabel>\r\n                  <IonIcon :icon=\"chevronDown\" slot=\"end\" />\r\n                </IonItem>\r\n              </template>\r\n\r\n              <!-- ✅ Migrado: slot=\"content\" -->\r\n              <template #content>\r\n                <div class=\"ion-padding\">\r\n                  <ul>\r\n                    <li\r\n                      v-for=\"(gusto, index) in profileData.gustos\"\r\n                      :key=\"index\"\r\n                    >\r\n                      {{ gusto }}\r\n                    </li>\r\n                  </ul>\r\n                </div>\r\n              </template>\r\n            </IonAccordion>\r\n\r\n            <!-- Acordeón Logros -->\r\n            <IonAccordion value=\"logros\">\r\n              <!-- ✅ Migrado: slot=\"header\" -->\r\n              <template #header>\r\n                <IonItem button @click=\"toggleAccordion('logros')\">\r\n                  <IonLabel>Logros</IonLabel>\r\n                  <IonIcon :icon=\"chevronDown\" slot=\"end\" />\r\n                </IonItem>\r\n              </template>\r\n\r\n              <!-- ✅ Migrado: slot=\"content\" -->\r\n              <template #content>\r\n                <div class=\"ion-padding\">\r\n                  <ul>\r\n                    <li\r\n                      v-for=\"(logro, index) in profileData.logros\"\r\n                      :key=\"index\"\r\n                    >\r\n                      {{ logro }}\r\n                    </li>\r\n                  </ul>\r\n                </div>\r\n              </template>\r\n            </IonAccordion>\r\n          </IonAccordionGroup>\r\n\r\n          <!-- Avatar y usuario -->\r\n          <div class=\"user-info-section\">\r\n            <div class=\"user-avatar-container\" @click=\"changeAvatar\">\r\n              <IonAvatar>\r\n                <IonImg\r\n                  :src=\"profileData.avatar_url\"\r\n                  alt=\"Avatar del usuario\"\r\n                />\r\n              </IonAvatar>\r\n              <input\r\n                type=\"file\"\r\n                ref=\"avatarInput\"\r\n                style=\"display: none\"\r\n                @change=\"handleFileChange\"\r\n                accept=\"image/*\"\r\n              />\r\n            </div>\r\n            <IonLabel class=\"username\">{{ profileData.username }}</IonLabel>\r\n          </div>\r\n        </IonCardContent>\r\n      </IonCard>\r\n    </IonContent>\r\n  </IonPage>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from \"vue\";\r\nimport {\r\n  IonPage,\r\n  IonHeader,\r\n  IonToolbar,\r\n  IonTitle,\r\n  IonContent,\r\n  IonCard,\r\n  IonCardContent,\r\n  IonItem,\r\n  IonLabel,\r\n  IonIcon,\r\n  IonAccordion,\r\n  IonAccordionGroup,\r\n  IonImg,\r\n  IonAvatar,\r\n} from \"@ionic/vue\";\r\nimport { chevronDown } from \"ionicons/icons\";\r\nimport { createClient } from \"@supabase/supabase-js\";\r\n\r\n// 👉 Supabase Client\r\nconst supabase = createClient(\r\n  \"https://neffqwnqpcydidpkysfi.supabase.co\",\r\n  \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\"\r\n);\r\n\r\n// Estado del acordeón\r\nconst activeAccordion = ref(null);\r\n\r\n// Perfil\r\nconst profileData = ref({\r\n  username: \"\",\r\n  avatar_url: \"\",\r\n  gustos: [],\r\n  logros: [],\r\n});\r\n\r\nconst avatarInput = ref(null);\r\n\r\n// 👉 Alternar acordeón\r\nconst toggleAccordion = (panelName) => {\r\n  activeAccordion.value =\r\n    activeAccordion.value === panelName ? null : panelName;\r\n};\r\n\r\n// 👉 Cambiar avatar\r\nconst changeAvatar = () => {\r\n  avatarInput.value.click();\r\n};\r\n\r\nconst handleFileChange = async (event) => {\r\n  const file = event.target.files[0];\r\n  if (!file) return;\r\n\r\n  try {\r\n    const filePath = `avatars/${profileData.value.username}/${Date.now()}.${file.name.split(\".\").pop()}`;\r\n\r\n    const { data, error } = await supabase.storage\r\n      .from(\"avatars\")\r\n      .upload(filePath, file);\r\n\r\n    if (error) throw error;\r\n\r\n    const publicUrl = `https://neffqwnqpcydidpkysfi.supabase.co/storage/v1/object/public/${data.path}`;\r\n\r\n    const { error: updateError } = await supabase\r\n      .from(\"profiles\")\r\n      .update({ avatar_url: publicUrl })\r\n      .eq(\"username\", profileData.value.username);\r\n\r\n    if (updateError) throw updateError;\r\n\r\n    profileData.value.avatar_url = publicUrl;\r\n    alert(\"✅ Imagen de perfil actualizada correctamente!\");\r\n  } catch (error) {\r\n    console.error(\"Error al subir la imagen:\", error.message);\r\n    alert(\"❌ Error al subir la imagen. Inténtalo de nuevo.\");\r\n  }\r\n};\r\n\r\n// 👉 Cargar datos del perfil\r\nconst fetchProfileData = async () => {\r\n  try {\r\n    const usuarioActual = JSON.parse(localStorage.getItem(\"usuario\"));\r\n    if (!usuarioActual) {\r\n      console.warn(\"No hay usuario autenticado.\");\r\n      return;\r\n    }\r\n\r\n    const { data, error } = await supabase\r\n      .from(\"perfiles\")\r\n      .select(\"nombre_perfil, avatar_url, gustos, logros\")\r\n      .eq(\"nombre_perfil\", usuarioActual.nombre)\r\n      .single();\r\n\r\n    if (error) throw error;\r\n\r\n    if (data) {\r\n      profileData.value.username = data.nombre_perfil;\r\n      profileData.value.avatar_url = data.avatar_url;\r\n      profileData.value.gustos = data.gustos || [];\r\n      profileData.value.logros = data.logros || [];\r\n    }\r\n  } catch (error) {\r\n    console.error(\"Error al cargar datos del perfil:\", error.message);\r\n  }\r\n};\r\n\r\nonMounted(() => {\r\n  fetchProfileData();\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n.user-info-section {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  margin-top: 16px;\r\n}\r\n\r\n.user-avatar-container {\r\n  cursor: pointer;\r\n}\r\n\r\n.username {\r\n  margin-top: 8px;\r\n  font-weight: bold;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}